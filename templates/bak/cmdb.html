{% extends "master.html" %}
{% block content %}
    <script>
        window.onload=init;
        function init()
        {
            showhide(1);
        }
        function showhide(n)
        {
            var box = document.getElementById("sidebar");
            var allLi=box.getElementsByTagName("li");
            var len = allLi.length;
            allLi[n].className="active";
        }
    </script>
    <script>
        function hostsync() {
            $.get("/cmdb/sync",function(data){
                if (data == "ok") {
                    document.getElementById("s1").style.display = "";
                }
                else {
                    document.getElementById("e1").style.display = "";
                }
            });
        }
    </script>
<div class="span9" id="content">
    <div id="msg"></div>
    <div id="s1" class="alert alert-success" style="display:none">
        <button class="close" data-dismiss="alert">&times;</button>
        <strong>Success!</strong> 同步执行成功.
    </div>
    <div id="e1"class="alert alert-error" style="display:none">
        <button class="close" data-dismiss="alert">&times;</button>
        <strong>Error!</strong> 同步错误，请检查环境！
    </div>
	 <div class="row-fluid">
		<!-- block -->
		<div class="block">
			<div class="navbar navbar-inner block-header">
				<div class="muted pull-left">Devices List</div>
			</div>
			<div class="block-content collapse in">
				<div class="span12">
				   <div class="table-toolbar">
					  <div class="btn-group">
						 <a href="/admin/cmdb/host/add/"><button class="btn btn-success">Add New <i class="icon-plus icon-white"></i></button></a>
					  </div>
					  <div class="btn-group">
						 <a href="/admin/cmdb/host/"><button class="btn btn-success">Manage Host </button></a>
					  </div>
                      <div class="btn-group">
                         <button class="btn btn-primary" onclick="return hostsync()">Sync Host Info To Ansible </button>
                      </div>
					  <div class="btn-group pull-right">
						 <button data-toggle="dropdown" class="btn dropdown-toggle">Tools <span class="caret"></span></button>
						 <ul class="dropdown-menu">
							<li><a href="excel">Export to Excel</a></li>
						 </ul>
					  </div>
				   </div>
					
					<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" id="example2">
						<thead>
							<tr>
								<th>主机名</th>
								<th>IP地址</th>
								<th>CPU</th>
								<th>内存</th>
								<th>硬盘</th>
								<th>操作系统</th>
							</tr>
						</thead>
						<tbody>
							{% if host_list %}
							{% for host in host_list %}
								<tr class="even gradeA">
									<td><a href="/admin/cmdb/host/{{  host.id }}">{{ host.hostname }} </a></td>
									<td>{{ host.ip }}</td>
									<td>{{ host.cpu_num }}</td>
									<td>{{ host.memory }}</td>
									<td>{{ host.disk }}</td>
									<td>{{ host.idc }}</td>
								</tr>
							{% endfor %}
							{% else %}
								<p>No host are available.</p>
							{% endif %}
                            </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!-- /block -->
                    </div>
                </div>
            </div>
{% endblock %}